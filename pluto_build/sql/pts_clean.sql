-- create table with target field names
DROP TABLE IF EXISTS dof_pts_propmaster;
CREATE TABLE dof_pts_propmaster (
	ID text,
	BORO text,
	TB text,
	TL text,
	STREET_NAME text,
	HOUSENUM_LO text,
	HOUSENUM_HI text,
	APTNO text,
	ZIP text,
	BLDGCL text,
	EASE text,
	OWNER text, 
	LAND_AREA text,
	GROSS_SQFT text,
	RESIDAREA text,
	OFFICEAREA text,
	RETAILAREA text,
	GARAGEAREA text,
	STORAGEAREA text,
	FACTORYAREA	text,
	OTHERAREA text,
	BLDGS text,
	STORY text,
	COOP_APTS text,
	UNITS text,
	LOT_FRT text,
	LOT_DEP text,
	BLD_FRT text,
	BLD_DEP text,
	EXT text,
	IRREG text,
	CURAVL_ACT text,
	CURAVT_ACT text,
	CUREXT_ACT text,
	YRBUILT text,
	YRALT1 text,
	YRALT2 text,
	CONDO_NUMBER text,
	AP_BORO text,
	AP_BLOCK text,
	AP_LOT text,
	AP_EASE text,
	AP_DATE text);
-- insert unique ids
INSERT INTO dof_pts_propmaster (ID)
SELECT DISTINCT "id" FROM pts;
-- insert values
UPDATE dof_pts_propmaster a
SET BORO = CASE WHEN "BORO" = '\"\"' THEN NULL ELSE "BORO" END,
	TB = CASE WHEN "BLOCK" = '\"\"' THEN NULL ELSE "BLOCK" END,
	TL = CASE WHEN "LOT" = '\"\"' THEN NULL ELSE "LOT" END,
	STREET_NAME = CASE WHEN "STREET_NAME" = '\"\"' THEN NULL ELSE "STREET_NAME" END,
	HOUSENUM_LO = CASE WHEN "HOUSENUM_LO" = '\"\"' THEN NULL ELSE "HOUSENUM_LO" END,
	HOUSENUM_HI = CASE WHEN "HOUSENUM_HI" = '\"\"' THEN NULL ELSE "HOUSENUM_HI" END,
	APTNO = CASE WHEN "APTNO" = '\"\"' THEN NULL ELSE "APTNO" END,
	ZIP = CASE WHEN "ZIP_CODE" = '\"\"' THEN NULL ELSE "ZIP_CODE" END,
	BLDGCL = CASE WHEN "BLDG_CLASS" = '\"\"' THEN NULL ELSE "BLDG_CLASS" END,
	EASE = CASE WHEN "EASE" = '\"\"' THEN NULL ELSE "EASE" END,
	OWNER = CASE WHEN "AV_OWNER" = '\"\"' THEN NULL ELSE "AV_OWNER" END,
	LAND_AREA = CASE WHEN REPLACE("LAND_AREA", '+', '') ~ '[0-9]+$' THEN REPLACE("LAND_AREA", '+', '') ELSE NULL END,
	GROSS_SQFT = CASE WHEN "GROSS_SQFT" = '\"\"' THEN NULL ELSE REPLACE("GROSS_SQFT", '+', '') END,
	RESIDAREA = CASE WHEN "RESIDENTIAL_AREA_GROSS" = '\"\"' THEN NULL ELSE REPLACE("RESIDENTIAL_AREA_GROSS", '+', '')::double precision END,
	OFFICEAREA =CASE WHEN "OFFICE_AREA_GROSS" = '\"\"' THEN NULL ELSE REPLACE("OFFICE_AREA_GROSS", '+', '')::double precision END,
	RETAILAREA = CASE WHEN "RETAIL_AREA_GROSS" = '\"\"' THEN NULL ELSE REPLACE("RETAIL_AREA_GROSS", '+', '')::double precision END,
	GARAGEAREA = CASE WHEN "GARAGE_AREA" = '\"\"' THEN NULL ELSE REPLACE("GARAGE_AREA", '+', '')::double precision END,
	STORAGEAREA = CASE WHEN "STORAGE_AREA_GROSS" = '\"\"' THEN NULL ELSE REPLACE("STORAGE_AREA_GROSS", '+', '')::double precision END,
	FACTORYAREA	= CASE WHEN "FACTORY_AREA_GROSS" = '\"\"' THEN NULL ELSE REPLACE("FACTORY_AREA_GROSS", '+', '')::double precision END,
	OTHERAREA = CASE WHEN "OTHER_AREA_GROSS" = '\"\"' THEN NULL ELSE REPLACE("OTHER_AREA_GROSS", '+', '')::double precision END,
	BLDGS = CASE WHEN "NUM_BLDGS" = '\"\"' THEN NULL ELSE REPLACE("NUM_BLDGS", '+', '') END,
	STORY = CASE WHEN "BLD_STORY" = '\"\"' THEN NULL ELSE REPLACE("BLD_STORY", '+', '') END,
	COOP_APTS = CASE WHEN "COOP_APTS" = '\"\"' THEN NULL ELSE REPLACE("COOP_APTS", '+', '')::double precision END,
	UNITS = CASE WHEN "UNITS" = '\"\"' THEN NULL ELSE REPLACE("UNITS", '+', '')::double precision END,
	LOT_FRT = CASE WHEN "LOT_FRT" = '\"\"' THEN NULL ELSE REPLACE("LOT_FRT", '+', '') END,
	LOT_DEP = CASE WHEN "LOT_DEP" = '\"\"' THEN NULL ELSE REPLACE("LOT_DEP", '+', '') END,
	BLD_FRT = CASE WHEN "BLD_FRT" = '\"\"' THEN NULL ELSE REPLACE("BLD_FRT", '+', '')END,
	BLD_DEP = CASE WHEN "BLD_DEP" = '\"\"' THEN NULL ELSE REPLACE("BLD_DEP", '+', '') END,
	EXT = CASE WHEN "BLD_EXT" = '\"\"' THEN NULL ELSE "BLD_EXT" END,
	IRREG = CASE WHEN "LOT_IRREG" = '\"\"' THEN NULL ELSE "LOT_IRREG" END,
	CURAVL_ACT = CASE WHEN REPLACE("PYACTLAND", '+', '') ~ '[0-9]+$' THEN REPLACE("PYACTLAND", '+', '') ELSE NULL END,
	CURAVT_ACT = CASE WHEN REPLACE("PYACTTOT", '+', '') ~ '[0-9]+$' THEN REPLACE("PYACTTOT", '+', '') ELSE NULL END,
	CUREXT_ACT = CASE WHEN REPLACE("PYACTEXTOT", '+', '') ~ '[0-9]+$' THEN REPLACE("PYACTEXTOT", '+', '') ELSE NULL END,
	YRBUILT = CASE WHEN "YRBUILT" = '\"\"' THEN NULL ELSE REPLACE("YRBUILT", '+', '') END,
	YRALT1 = CASE WHEN "YRALT1" = '\"\"' THEN NULL ELSE REPLACE("YRALT1", '+', '') END,
	YRALT2 = CASE WHEN "YRALT2" = '\"\"' THEN NULL ELSE REPLACE("YRALT2", '+', '') END,
	CONDO_NUMBER = CASE WHEN "CONDO_Number" = '\"\"' THEN NULL ELSE "CONDO_Number" END,
	AP_BORO = CASE WHEN "APPT_BORO" = '\"\"' THEN NULL ELSE "APPT_BORO" END,
	AP_BLOCK = CASE WHEN "APPT_BLOCK" = '\"\"' THEN NULL ELSE "APPT_BLOCK" END,
	AP_LOT = CASE WHEN "APPT_LOT" = '\"\"' THEN NULL ELSE "APPT_LOT" END,
	AP_EASE = CASE WHEN "APPT_EASE" = '\"\"' THEN NULL ELSE "APPT_EASE" END,
	AP_DATE = CASE WHEN "APPT_DATE" = '\"\"' THEN NULL ELSE "APPT_DATE" END
FROM pts b
WHERE a.id::text=b.id::text;
